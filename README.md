
<h1>Автоматизация переноса данных из поставщика "АвантМаркет" в "Мой склад"</h1>

<h2>Описание</h2>
<p>Скрипт предназначен для автоматизации работы с каталогом товаров Avantmarket. Он выполняет скачивание данных, их обработку, создание товарных позиций, категорий, загрузку изображений и обновление остатков на платформе "МойСклад".</p>

<h2>Используемые библиотеки</h2>
<ul>
    <li><code>base64</code> — кодирование учетных данных в Base64 для аутентификации.</li>
    <li><code>xml.etree.ElementTree</code> — обработка XML-файлов с каталогом товаров.</li>
    <li><code>csv</code> — работа с CSV-файлами для экспорта данных.</li>
    <li><code>requests</code> — выполнение HTTP-запросов к API "МойСклад".</li>
    <li><code>datetime</code> — работа с датами и временем.</li>
    <li><code>json</code> — обработка данных в формате JSON.</li>
    <li><code>os</code> — управление файлами и директориями.</li>
    <li><code>pandas</code> — обработка и анализ табличных данных.</li>
    <li><code>time</code> — управление задержками выполнения скрипта.</li>
    <li><code>yadisk</code> — загрузка изображений в Яндекс.Диск.</li>
</ul>

<h2>Функционал скрипта</h2>

<h3>1. Аутентификация в API "МойСклад"</h3>
<p>Скрипт использует HTTP Basic Authentication. Логин и пароль кодируются в Base64 и передаются в заголовке запроса.</p>

<h3>2. Скачивание файлов</h3>
<p>Скрипт скачивает XML-файл каталога товаров с сайта Avantmarket и сохраняет его локально.</p>

<h3>3. Обработка каталога товаров</h3>
<p>Скрипт парсит XML-файл и извлекает данные о товарах, включая:</p>
<ul>
    <li>Идентификатор товара</li>
    <li>Наличие на складе</li>
    <li>Ссылки на изображения</li>
    <li>Цены, скидки и валюту</li>
    <li>Категории товаров</li>
    <li>Штрих-коды, модели и вес</li>
    <li>Описание товара</li>
</ul>
<p>Данные сохраняются в CSV-файле.</p>

<h3>4. Создание категорий</h3>
<p>Скрипт загружает категории товаров в "МойСклад". Категории распределяются по родительским группам.</p>

<h3>5. Обработка изображений</h3>
<p>Скрипт скачивает изображения товаров и загружает их в Яндекс.Диск. Создаются ссылки на папки с изображениями.</p>

<h3>6. Создание товаров в "МойСклад"</h3>
<p>На основе обработанных данных создаются карточки товаров в "МойСклад" с указанием:</p>
<ul>
    <li>Названия товара</li>
    <li>Категории</li>
    <li>Цены и скидки</li>
    <li>Описание с параметрами</li>
    <li>Штрих-кодов</li>
    <li>Изображений</li>
</ul>

<h3>7. Управление остатками</h3>
<p>Скрипт проверяет текущие остатки в "МойСклад" и при необходимости создает приходные и расходные документы.</p>

<h3>8. Автоматическая периодическая очистка и обновление</h3>
<p>Каждые 5 дней скрипт:</p>
<ul>
    <li>Удаляет старые товары, категории и остатки</li>
    <li>Скачивает и загружает актуальные данные</li>
    <li>Обновляет информацию о товарах</li>
</ul>

<h2>Как запустить скрипт</h2>

<h3>1. Установка Visual Studio Code</h3>
<ol>
    <li>Скачайте <a href="https://code.visualstudio.com/">VSCode</a> и установите его.</li>
</ol>

<h3>2. Установка Python</h3>
<ol>
    <li>Скачайте и установите <a href="https://www.python.org/">Python</a>, отметив галочку "Add to PATH".</li>
</ol>

<h3>3. Установка зависимостей</h3>
<ol>
    <li>Откройте терминал в VSCode (Ctrl+`).</li>
    <li>Создайте виртуальное окружение:
        <pre><code>python -m venv venv</code></pre>
    </li>
    <li>Активируйте окружение:
        <pre><code>venv\Scripts\activate</code> (Windows)</pre>
        <pre><code>source venv/bin/activate</code> (Mac/Linux)</pre>
    </li>
    <li>Установите зависимости:
        <pre><code>pip install requests pandas yadisk</code></pre>
    </li>
</ol>

<h3>4. Установка драйвера браузера (если требуется)</h3>
<p>Для автоматизации браузера (если будет добавлена работа с Selenium) скачайте ChromeDriver с <a href="https://chromedriver.chromium.org/downloads">официального сайта</a>.</p>

<h3>5. Настройка учетных данных</h3>
<p>Перед запуском замените учетные данные (логин и пароль) на актуальные.</p>

<h3>6. Запуск скрипта</h3>
<ol>
    <li>Запустите скрипт командой:
        <pre><code>python final_code.py</code></pre>
    </li>
    <li>Следите за выводом в терминале.</li>
</ol>

<h2>Отладка и возможные ошибки</h2>
<ul>
    <li>Если скрипт не запускается, убедитесь, что Python установлен и добавлен в PATH.</li>
    <li>Если проблемы с API, проверьте правильность учетных данных и наличие доступа.</li>
    <li>Если возникают ошибки при скачивании файлов, убедитесь, что URL-адреса актуальны.</li>
</ul>

<h2>Примечания</h2>
<p>Скрипт выполняет автоматические операции с "МойСклад", поэтому перед запуском рекомендуется протестировать его на тестовых данных.</p>

